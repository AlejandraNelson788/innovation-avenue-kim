The encoding algorithm follows the given spec, so no innovations there. A few optimizations are made however
